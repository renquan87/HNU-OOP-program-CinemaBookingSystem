# ç”µå½±é™¢è®¢ç¥¨ç³»ç»Ÿ - å‰ç«¯è¯¦ç»†è®²è§£

> æœ¬æ–‡æ¡£è¯¦ç»†è®²è§£å‰ç«¯é¡¹ç›®çš„æ¶æ„ã€ä»£ç ç»“æ„å’Œå®ç°ç»†èŠ‚ï¼Œä¸“ä¸ºåˆå­¦è€…ç¼–å†™ã€‚

---

## ç›®å½•
1. [å‰ç«¯æŠ€æœ¯æ ˆ](#å‰ç«¯æŠ€æœ¯æ ˆ)
2. [é¡¹ç›®æ–‡ä»¶ç»“æ„](#é¡¹ç›®æ–‡ä»¶ç»“æ„)
3. [æ ¸å¿ƒæ¦‚å¿µè®²è§£](#æ ¸å¿ƒæ¦‚å¿µè®²è§£)
4. [ä»£ç æ‰§è¡Œæµç¨‹](#ä»£ç æ‰§è¡Œæµç¨‹)
5. [å…³é”®ä»£ç è¯¦è§£](#å…³é”®ä»£ç è¯¦è§£)
6. [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”)

---

## å‰ç«¯æŠ€æœ¯æ ˆ

### ä¸»è¦æŠ€æœ¯æ¡†æ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Vue 3 (å‰ç«¯æ¡†æ¶)                     â”‚
â”‚  â€¢ ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢                       â”‚
â”‚  â€¢ ç»„ä»¶å¼å¼€å‘ï¼Œæ˜“äºç»´æŠ¤                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     TypeScript (ç¼–ç¨‹è¯­è¨€)                â”‚
â”‚  â€¢ æä¾›ç±»å‹æ£€æŸ¥ï¼Œå‡å°‘ bug                  â”‚
â”‚  â€¢ æ›´å¥½çš„ä»£ç æç¤ºå’Œé‡æ„                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Vite (æ„å»ºå·¥å…·)                      â”‚
â”‚  â€¢ å¿«é€Ÿå¼€å‘æœåŠ¡å™¨ï¼ˆhot reloadï¼‰           â”‚
â”‚  â€¢ ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ä¼˜åŒ–                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Element Plus (UI ç»„ä»¶åº“)              â”‚
â”‚  â€¢ æä¾›æŒ‰é’®ã€å¯¹è¯æ¡†ã€è¡¨æ ¼ç­‰ç»„ä»¶             â”‚
â”‚  â€¢ ç¾è§‚çš„é»˜è®¤æ ·å¼                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Pinia (çŠ¶æ€ç®¡ç†)                     â”‚
â”‚  â€¢ ç®¡ç†å…¨å±€æ•°æ®ï¼ˆç”¨æˆ·ä¿¡æ¯ç­‰ï¼‰              â”‚
â”‚  â€¢ è·¨ç»„ä»¶é€šä¿¡                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸ºä»€ä¹ˆä½¿ç”¨è¿™äº›æŠ€æœ¯ï¼Ÿ

| æŠ€æœ¯ | ä½œç”¨ | ä¸ºä»€ä¹ˆé€‰æ‹© |
|------|------|----------|
| Vue 3 | æ„å»ºç”¨æˆ·ç•Œé¢ | æ˜“å­¦æ˜“ç”¨ï¼Œæ–‡æ¡£å®Œå–„ |
| TypeScript | ç¼–ç¨‹è¯­è¨€ | ç±»å‹æ£€æŸ¥ï¼Œå‡å°‘ bug |
| Vite | å¼€å‘å’Œæ„å»º | é€Ÿåº¦å¿«ï¼Œçƒ­æ›´æ–°å¿« |
| Element Plus | UI ç»„ä»¶åº“ | ç»„ä»¶ä¸°å¯Œï¼Œå¼€ç®±å³ç”¨ |
| Pinia | çŠ¶æ€ç®¡ç† | æ¯” Vuex æ›´ç®€å• |

---

## é¡¹ç›®æ–‡ä»¶ç»“æ„

### å®Œæ•´çš„æ–‡ä»¶æ ‘

```
web/                                    # å‰ç«¯é¡¹ç›®ç›®å½•
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                        # åº”ç”¨å…¥å£ï¼ˆåˆå§‹åŒ– Vueï¼‰
â”‚   â”œâ”€â”€ App.vue                        # æ ¹ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                           # ğŸ‘ˆ API è¯·æ±‚æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ booking.ts                 # è®¢ç¥¨ç›¸å…³ API
â”‚   â”‚   â”œâ”€â”€ cinema.ts                  # ç”µå½±ã€åœºæ¬¡ã€åº§ä½ API
â”‚   â”‚   â”œâ”€â”€ user.ts                    # ç”¨æˆ·è®¤è¯ API
â”‚   â”‚   â””â”€â”€ cinema/
â”‚   â”‚       â””â”€â”€ movie/
â”‚   â”‚           â””â”€â”€ showModel.ts       # æ•°æ®ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ views/                         # ğŸ‘ˆ é¡µé¢ç»„ä»¶ï¼ˆè·¯ç”±å¯¹åº”ï¼‰
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.vue              # ç™»å½•é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚   â”‚       â””â”€â”€ LoginRegist.vue    # æ³¨å†Œå­ç»„ä»¶
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ cinema/
â”‚   â”‚       â”œâ”€â”€ portal/
â”‚   â”‚       â”‚   â”œâ”€â”€ index.vue          # ç”µå½±é¦–é¡µ
â”‚   â”‚       â”‚   â””â”€â”€ detail.vue         # ç”µå½±è¯¦æƒ…é¡µ
â”‚   â”‚       â”œâ”€â”€ seat.vue               # åº§ä½é€‰æ‹©é¡µ
â”‚   â”‚       â”œâ”€â”€ schedule/
â”‚   â”‚       â”‚   â””â”€â”€ index.vue          # åœºæ¬¡åˆ—è¡¨é¡µ
â”‚   â”‚       â””â”€â”€ order/
â”‚   â”‚           â””â”€â”€ index.vue          # è®¢å•ç®¡ç†é¡µ
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                    # ğŸ‘ˆ å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ReBookingDialog/           # è´­ç¥¨å¯¹è¯æ¡†
â”‚   â”‚   â”‚   â””â”€â”€ index.vue
â”‚   â”‚   â”œâ”€â”€ AiAssistant/               # AI åŠ©æ‰‹
â”‚   â”‚   â”‚   â””â”€â”€ index.vue
â”‚   â”‚   â””â”€â”€ ReIcon/                    # å›¾æ ‡ç»„ä»¶
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ store/                         # ğŸ‘ˆ Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”‚   â”œâ”€â”€ user.ts                # ç”¨æˆ·çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ app.ts                 # åº”ç”¨çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ permission.ts          # æƒé™çŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ settings.ts            # è®¾ç½®çŠ¶æ€
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ router/                        # ğŸ‘ˆ è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ index.ts                   # è·¯ç”±åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ utils.ts                   # è·¯ç”±å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ modules/
â”‚   â”‚       â”œâ”€â”€ cinema.ts              # ç”µå½±ç›¸å…³è·¯ç”±
â”‚   â”‚       â”œâ”€â”€ system.ts              # ç³»ç»Ÿç›¸å…³è·¯ç”±
â”‚   â”‚       â””â”€â”€ remaining.ts           # å…¶ä»–è·¯ç”±
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                         # ğŸ‘ˆ å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ http.ts                    # HTTP è¯·æ±‚å·¥å…·
â”‚   â”‚   â”œâ”€â”€ auth.ts                    # è®¤è¯ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ message.ts                 # æ¶ˆæ¯æç¤º
â”‚   â”‚   â””â”€â”€ responsive.ts              # å“åº”å¼ç›¸å…³
â”‚   â”‚
â”‚   â”œâ”€â”€ plugins/                       # ğŸ‘ˆ Vue æ’ä»¶
â”‚   â”‚   â”œâ”€â”€ i18n/                      # å›½é™…åŒ–ï¼ˆä¸­è‹±æ–‡ï¼‰
â”‚   â”‚   â”œâ”€â”€ elementPlus.ts             # Element Plus é…ç½®
â”‚   â”‚   â””â”€â”€ echarts.ts                 # å›¾è¡¨åº“é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ layout/                        # ğŸ‘ˆ å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ index.vue                  # ä¸»å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useNav.ts              # å¯¼èˆªé€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ useLayout.ts           # å¸ƒå±€é€»è¾‘
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚       â”œâ”€â”€ Navbar/                # é¡¶éƒ¨å¯¼èˆª
â”‚   â”‚       â”œâ”€â”€ Sidebar/               # å·¦ä¾§èœå•
â”‚   â”‚       â””â”€â”€ Footer/                # é¡µè„š
â”‚   â”‚
â”‚   â”œâ”€â”€ style/                         # ğŸ‘ˆ æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ index.scss                 # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ reset.scss                 # é‡ç½®æ ·å¼
â”‚   â”‚   â”œâ”€â”€ tailwind.css               # Tailwind CSS
â”‚   â”‚   â””â”€â”€ variables.scss             # æ ·å¼å˜é‡
â”‚   â”‚
â”‚   â”œâ”€â”€ assets/                        # ğŸ‘ˆ é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ iconfont/                  # å­—ä½“å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ svg/                       # SVG å›¾æ ‡
â”‚   â”‚   â””â”€â”€ images/                    # å›¾ç‰‡
â”‚   â”‚
â”‚   â”œâ”€â”€ directives/                    # ğŸ‘ˆ è‡ªå®šä¹‰æŒ‡ä»¤
â”‚   â”‚   â”œâ”€â”€ copy.ts                    # å¤åˆ¶æŒ‡ä»¤
â”‚   â”‚   â”œâ”€â”€ focus.ts                   # ç„¦ç‚¹æŒ‡ä»¤
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                        # ğŸ‘ˆ é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ index.ts                   # åº”ç”¨é…ç½®
â”‚   â”‚
â”‚   â””â”€â”€ types/                         # ğŸ‘ˆ TypeScript ç±»å‹
â”‚       â”œâ”€â”€ global.d.ts                # å…¨å±€ç±»å‹
â”‚       â””â”€â”€ router.d.ts                # è·¯ç”±ç±»å‹
â”‚
â”œâ”€â”€ public/                            # å…¬å¼€èµ„æºï¼ˆä¸éœ€è¦å¤„ç†ï¼‰
â”‚   â”œâ”€â”€ index.html                     # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ platform-config.json           # å¹³å°é…ç½®
â”‚   â”œâ”€â”€ media/                         # åª’ä½“æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€è§†é¢‘ï¼‰
â”‚   â””â”€â”€ wasm/                          # WebAssembly æ–‡ä»¶
â”‚
â”œâ”€â”€ vite.config.ts                     # Vite é…ç½®æ–‡ä»¶
â”œâ”€â”€ tsconfig.json                      # TypeScript é…ç½®
â”œâ”€â”€ package.json                       # é¡¹ç›®ä¾èµ–
â””â”€â”€ pnpm-lock.yaml                     # ä¾èµ–ç‰ˆæœ¬é”å®š
```

### å…³é”®æ–‡ä»¶è¯´æ˜

#### ğŸ“„ main.tsï¼ˆåº”ç”¨å…¥å£ï¼‰
```typescript
// è¿™æ˜¯å‰ç«¯åº”ç”¨å¯åŠ¨çš„åœ°æ–¹
// ä½œç”¨ï¼š
// 1. å¯¼å…¥ Vue
// 2. å¯¼å…¥ App.vueï¼ˆæ ¹ç»„ä»¶ï¼‰
// 3. å¯¼å…¥ routerï¼ˆè·¯ç”±ï¼‰ã€storeï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
// 4. åˆ›å»ºåº”ç”¨å®ä¾‹
// 5. æŒ‚è½½åˆ° #app å…ƒç´ 
```

#### ğŸ“„ App.vueï¼ˆæ ¹ç»„ä»¶ï¼‰
```typescript
// æ‰€æœ‰é¡µé¢çš„çˆ¶ç»„ä»¶
// åŒ…å«ï¼š
// 1. <router-view /> - è·¯ç”±å‡ºå£ï¼ˆé¡µé¢å†…å®¹æ˜¾ç¤ºåœ¨è¿™é‡Œï¼‰
// 2. <ReDialog /> - å…¨å±€å¯¹è¯æ¡†
// 3. <ReDrawer /> - å…¨å±€æŠ½å±‰
```

#### ğŸ“„ vite.config.tsï¼ˆæ„å»ºé…ç½®ï¼‰
```typescript
// é‡è¦é…ç½®ï¼š
// 1. å¼€å‘æœåŠ¡å™¨ server.port: 5173
// 2. ä»£ç†é…ç½®ï¼šæŠŠ /api è½¬å‘åˆ°åç«¯ :8081
// 3. æ„å»ºä¼˜åŒ–
```

---

## æ ¸å¿ƒæ¦‚å¿µè®²è§£

### 1. Vue 3 çš„æ ¸å¿ƒæ¦‚å¿µ

#### âœ¨ ä»€ä¹ˆæ˜¯ç»„ä»¶ï¼Ÿ

ç»„ä»¶æ˜¯å¯å¤ç”¨çš„ Vue å®ä¾‹ã€‚ä¸€ä¸ª `.vue` æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç»„ä»¶ã€‚

**ç»„ä»¶çš„ä¸‰éƒ¨åˆ†ï¼š**

```vue
<template>
  <!-- HTML éƒ¨åˆ† - å®šä¹‰ UI ç»“æ„ -->
  <div>{{ message }}</div>
</template>

<script setup lang="ts">
  // JavaScript éƒ¨åˆ† - å®šä¹‰é€»è¾‘
  import { ref } from "vue";
  const message = ref("Hello World");
</script>

<style scoped>
  /* CSS éƒ¨åˆ† - å®šä¹‰æ ·å¼ */
  div {
    color: red;
  }
</style>
```

#### ğŸ”„ å“åº”å¼æ•°æ®ï¼ˆrefï¼‰

ä½¿ç”¨ `ref()` åˆ›å»ºå“åº”å¼å˜é‡ï¼Œå½“å˜é‡æ”¹å˜æ—¶ï¼Œé¡µé¢è‡ªåŠ¨æ›´æ–°ã€‚

```typescript
import { ref } from "vue";

// åˆ›å»ºå“åº”å¼å˜é‡
const count = ref(0);

// è®¿é—®å€¼éœ€è¦ .value
console.log(count.value);  // 0

// åœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨ï¼ˆä¸éœ€è¦ .valueï¼‰
// <div>{{ count }}</div>
```

**ä¸ºä»€ä¹ˆéœ€è¦ refï¼Ÿ**

- æ²¡æœ‰ refï¼šä¿®æ”¹å˜é‡åï¼Œé¡µé¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°
- æœ‰ refï¼šä¿®æ”¹å˜é‡åï¼ŒVue è‡ªåŠ¨è¿½è¸ªï¼Œé¡µé¢è‡ªåŠ¨æ›´æ–°

#### ğŸ¯ ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆonMountedï¼‰

ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ä»åˆ›å»ºåˆ°é”€æ¯çš„è¿‡ç¨‹ã€‚

```typescript
import { onMounted } from "vue";

export default {
  setup() {
    onMounted(() => {
      // å½“ç»„ä»¶æŒ‚è½½åï¼ˆåŠ è½½å®Œæˆï¼‰æ‰§è¡Œ
      // é€šå¸¸åœ¨è¿™é‡Œè·å–æ•°æ®
      console.log("ç»„ä»¶å·²åŠ è½½");
    });
  }
};
```

**å¸¸ç”¨é’©å­ï¼š**

```
ç»„ä»¶åˆ›å»º  â†’  ç»„ä»¶æŒ‚è½½  â†’  ç»„ä»¶æ›´æ–°  â†’  ç»„ä»¶é”€æ¯
   â”‚         â”‚           â”‚         â”‚
  created  onMounted   onUpdated  onUnmounted
```

**ä¾‹å­ï¼šç”µå½±é¡µé¢åŠ è½½æ—¶è·å–æ•°æ®**

```typescript
onMounted(() => {
  // å½“é¡µé¢åŠ è½½æ—¶ï¼Œè‡ªåŠ¨è·å–ç”µå½±åˆ—è¡¨
  loadMovies();
});
```

#### ğŸ’¾ è®¡ç®—å±æ€§ï¼ˆcomputedï¼‰

æ ¹æ®å…¶ä»–æ•°æ®è‡ªåŠ¨è®¡ç®—å¾—å‡ºçš„æ•°æ®ã€‚

```typescript
import { ref, computed } from "vue";

const selectedSeats = ref([1, 2]);  // ç”¨æˆ·é€‰ä¸­çš„åº§ä½
const seatPrices = ref([50, 50]);   // åº§ä½ä»·æ ¼

// è‡ªåŠ¨è®¡ç®—æ€»ä»·
const totalPrice = computed(() => {
  return seatPrices.value.reduce((sum, price) => sum + price, 0);
});

// å½“ selectedSeats æˆ– seatPrices æ”¹å˜æ—¶ï¼ŒtotalPrice è‡ªåŠ¨é‡æ–°è®¡ç®—
```

**ä¼˜ç‚¹ï¼š**
- é¿å…é‡å¤è®¡ç®—
- æ•°æ®æ”¹å˜æ—¶è‡ªåŠ¨æ›´æ–°
- ä»£ç ç®€æ´

### 2. çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰

#### ä»€ä¹ˆæ˜¯çŠ¶æ€ç®¡ç†ï¼Ÿ

çŠ¶æ€å°±æ˜¯æ•°æ®ã€‚çŠ¶æ€ç®¡ç†å°±æ˜¯**ç®¡ç†å…¨å±€æ•°æ®**ï¼ˆå¯ä»¥è¢«å¤šä¸ªç»„ä»¶å…±äº«çš„æ•°æ®ï¼‰ã€‚

**ä¸ç”¨çŠ¶æ€ç®¡ç†çš„é—®é¢˜ï¼š**

```
é¡¶å±‚ç»„ä»¶
  â”œâ”€ å­ç»„ä»¶ Aï¼ˆéœ€è¦ userIdï¼‰
  â”œâ”€ å­ç»„ä»¶ Bï¼ˆéœ€è¦ userIdï¼‰
  â””â”€ å­ç»„ä»¶ Cï¼ˆéœ€è¦ userIdï¼‰

âŒ éœ€è¦å±‚å±‚ä¼ é€’ userIdï¼Œå¾ˆéº»çƒ¦
```

**ä½¿ç”¨ Pinia çš„ä¼˜ç‚¹ï¼š**

```
Pinia Storeï¼ˆuserIdï¼‰
  â†‘
  â”‚ ä»»ä½•ç»„ä»¶éƒ½å¯ä»¥ç›´æ¥è·å–å’Œä¿®æ”¹
  â”‚
â”Œâ”€â”´â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚       â”‚       â”‚
å­ç»„ä»¶A  å­ç»„ä»¶B  å­ç»„ä»¶C

âœ… ä»»ä½•ç»„ä»¶å¯ä»¥ç›´æ¥è®¿é—® userId
```

#### Pinia çš„ä¸‰ä¸ªéƒ¨åˆ†

**1. Stateï¼ˆçŠ¶æ€ - æ•°æ®ï¼‰**

```typescript
// store/modules/user.ts
export const useUserStore = defineStore("pure-user", {
  state: () => ({
    userId: "",           // ç”¨æˆ·ID
    username: "",         // ç”¨æˆ·å
    roles: [],           // è§’è‰²åˆ—è¡¨
  })
});
```

**2. Actionsï¼ˆåŠ¨ä½œ - ä¿®æ”¹æ•°æ®çš„æ–¹æ³•ï¼‰**

```typescript
export const useUserStore = defineStore("pure-user", {
  state: () => ({
    userId: "",
    username: ""
  }),
  actions: {
    // ç™»å½•æ–¹æ³•
    async login(data) {
      const response = await getLogin(data);
      this.userId = response.data.userId;
      this.username = response.data.username;
    },
    
    // ç™»å‡ºæ–¹æ³•
    logout() {
      this.userId = "";
      this.username = "";
    }
  }
});
```

**3. Gettersï¼ˆè·å–å™¨ - è¯»å–æ•°æ®çš„æ–¹æ³•ï¼‰**

```typescript
export const useUserStore = defineStore("pure-user", {
  state: () => ({
    userId: "",
  }),
  getters: {
    // åˆ¤æ–­æ˜¯å¦å·²ç™»å½•
    isLoggedIn(): boolean {
      return this.userId !== "";
    }
  }
});
```

#### å¦‚ä½•ä½¿ç”¨ Pinia

```typescript
// åœ¨ä»»ä½•ç»„ä»¶ä¸­
import { useUserStoreHook } from "@/store/modules/user";

export default {
  setup() {
    const userStore = useUserStoreHook();
    
    // è¯»å–çŠ¶æ€
    console.log(userStore.userId);
    console.log(userStore.username);
    
    // ä¿®æ”¹çŠ¶æ€
    userStore.userId = "user123";
    
    // è°ƒç”¨ action
    userStore.login({ username: "user123", password: "pass123" });
    
    // ä½¿ç”¨ getter
    if (userStore.isLoggedIn) {
      console.log("å·²ç™»å½•");
    }
  }
};
```

### 3. è·¯ç”±ï¼ˆRouterï¼‰

#### ä»€ä¹ˆæ˜¯è·¯ç”±ï¼Ÿ

è·¯ç”±å°±æ˜¯ **URL åœ°å€ä¸é¡µé¢çš„å¯¹åº”å…³ç³»**ã€‚

```
URL åœ°å€                    é¡µé¢ç»„ä»¶
/login            â†’    views/login/index.vue
/cinema           â†’    views/cinema/portal/index.vue
/cinema/seat      â†’    views/cinema/seat.vue
/cinema/order     â†’    views/cinema/order/index.vue
```

#### è·¯ç”±é…ç½®

```typescript
// router/modules/cinema.ts
export default {
  path: "/cinema",
  component: LayoutComponent,
  children: [
    {
      path: "portal",
      component: () => import("@/views/cinema/portal/index.vue"),
      meta: { title: "ç”µå½±é¦–é¡µ" }
    },
    {
      path: "seat",
      component: () => import("@/views/cinema/seat.vue"),
      meta: { title: "åº§ä½é€‰æ‹©" }
    },
    {
      path: "order",
      component: () => import("@/views/cinema/order/index.vue"),
      meta: { title: "æˆ‘çš„è®¢å•" }
    }
  ]
};
```

#### è·¯ç”±å¯¼èˆª

```typescript
import { useRouter } from "vue-router";

const router = useRouter();

// æ–¹å¼1ï¼šè·³è½¬åˆ°è·¯ç”±
router.push("/cinema/portal");

// æ–¹å¼2ï¼šå¸¦å‚æ•°è·³è½¬
router.push({ 
  name: "MovieDetail", 
  params: { id: "MOV-001" } 
});

// æ–¹å¼3ï¼šæŸ¥è¯¢å‚æ•°
router.push({ 
  path: "/cinema/seat",
  query: { showId: "SHOW-001" }
});
```

#### è·å–è·¯ç”±å‚æ•°

```typescript
import { useRoute } from "vue-router";

const route = useRoute();

// è·å–åŠ¨æ€å‚æ•°ï¼ˆ/:idï¼‰
console.log(route.params.id);

// è·å–æŸ¥è¯¢å‚æ•°ï¼ˆ?showId=xxxï¼‰
console.log(route.query.showId);
```

### 4. ç½‘ç»œè¯·æ±‚ï¼ˆHTTPï¼‰

#### ä»€ä¹ˆæ˜¯ HTTP è¯·æ±‚ï¼Ÿ

HTTP è¯·æ±‚å°±æ˜¯**å‰ç«¯å‘åç«¯ç´¢è¦æ•°æ®æˆ–å‘é€æ•°æ®**çš„æ–¹å¼ã€‚

```
å‰ç«¯ï¼ˆæµè§ˆå™¨ï¼‰
    â”‚
    â”‚ å‘é€ HTTP è¯·æ±‚
    â”‚ (GET /api/movies)
    â–¼
åç«¯ï¼ˆæœåŠ¡å™¨ï¼‰
    â”‚ å¤„ç†è¯·æ±‚
    â”‚ æŸ¥è¯¢æ•°æ®åº“
    â–¼
åç«¯è¿”å›å“åº”
    â”‚ (JSON æ•°æ®)
    â–¼
å‰ç«¯æ¥æ”¶æ•°æ®
    â”‚ è§£æ JSON
    â”‚ æ›´æ–°é¡µé¢
    â–¼
ç”¨æˆ·çœ‹åˆ°æ•°æ®
```

#### ä½¿ç”¨ API å‡½æ•°

```typescript
// api/cinema.ts
export const getMovieList = () => {
  return http.request<any>("get", "/api/movies");
};

export const createOrder = (data) => {
  return http.request<any>("post", "/api/booking/create", { data });
};
```

#### åœ¨é¡µé¢ä¸­è°ƒç”¨ API

```typescript
import { ref, onMounted } from "vue";
import { getMovieList, createOrder } from "@/api/cinema";

export default {
  setup() {
    const movies = ref([]);
    const loading = ref(false);
    
    // è·å–ç”µå½±åˆ—è¡¨
    const fetchMovies = async () => {
      loading.value = true;
      try {
        const result = await getMovieList();
        if (result.success) {
          movies.value = result.data;
        }
      } finally {
        loading.value = false;
      }
    };
    
    // ä¸‹å•
    const handleOrder = async (orderData) => {
      const result = await createOrder(orderData);
      if (result.success) {
        console.log("ä¸‹å•æˆåŠŸ");
      }
    };
    
    // é¡µé¢åŠ è½½æ—¶è·å–ç”µå½±
    onMounted(() => {
      fetchMovies();
    });
    
    return { movies, loading, handleOrder };
  }
};
```

---

## ä»£ç æ‰§è¡Œæµç¨‹

### åœºæ™¯ï¼šç”¨æˆ·å®Œæ•´çš„è´­ç¥¨æµç¨‹

è®©æˆ‘ä»¬ä»ç”¨æˆ·æ‰“å¼€æµè§ˆå™¨åˆ°å®Œæˆè´­ç¥¨çš„å…¨è¿‡ç¨‹ï¼š

```
1ï¸âƒ£ ç”¨æˆ·æ‰“å¼€æµè§ˆå™¨
   â”‚
   â–¼
2ï¸âƒ£ åŠ è½½ index.html
   index.html
   <div id="app"></div>
   <script src="main.ts"></script>
   â”‚
   â–¼
3ï¸âƒ£ æ‰§è¡Œ main.tsï¼ˆåº”ç”¨å…¥å£ï¼‰
   â€¢ å¯¼å…¥ Vue
   â€¢ å¯¼å…¥ App.vue
   â€¢ å¯¼å…¥ router å’Œ store
   â€¢ åˆ›å»ºåº”ç”¨å®ä¾‹
   â€¢ æŒ‚è½½åˆ° #app
   â”‚
   â–¼
4ï¸âƒ£ åŠ è½½ App.vueï¼ˆæ ¹ç»„ä»¶ï¼‰
   â€¢ æ˜¾ç¤º <router-view />
   â€¢ å½“å‰è·¯ç”±æ˜¯ /loginï¼Œæ˜¾ç¤ºç™»å½•é¡µ
   â”‚
   â–¼
5ï¸âƒ£ æ˜¾ç¤ºç™»å½•é¡µï¼ˆviews/login/index.vueï¼‰
   â€¢ ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
   â€¢ ç‚¹å‡»ç™»å½•æŒ‰é’®
   â”‚
   â–¼
6ï¸âƒ£ æ‰§è¡Œç™»å½•é€»è¾‘
   // login/index.vue
   const onLogin = async () => {
     // è°ƒç”¨ç™»å½• API
     const response = await getLogin({
       username: "user123",
       password: "pass123"
     });
     
     // ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ° Pinia store
     userStore.SET_USERID(response.data.userId);
     userStore.SET_USERNAME(response.data.username);
     
     // è·³è½¬åˆ°ç”µå½±é¦–é¡µ
     router.push("/cinema/portal");
   };
   â”‚
   â–¼
7ï¸âƒ£ æ˜¾ç¤ºç”µå½±é¦–é¡µï¼ˆviews/cinema/portal/index.vueï¼‰
   onMounted(() => {
     // è·å–ç”µå½±åˆ—è¡¨
     loadMovies();  // è°ƒç”¨ API: GET /api/movies
   });
   â”‚
   â–¼
8ï¸âƒ£ åç«¯è¿”å›ç”µå½±åˆ—è¡¨
   [
     { id: "MOV-001", title: "é»‘è±¹2", rating: 8.5 },
     { id: "MOV-002", title: "é˜¿å‡¡è¾¾", rating: 8.8 }
   ]
   â”‚
   â–¼
9ï¸âƒ£ å‰ç«¯æ›´æ–°é¡µé¢ï¼Œæ˜¾ç¤ºç”µå½±å¡ç‰‡
   é¡µé¢æ˜¾ç¤ºï¼š
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  é»‘è±¹2  8.5â­   â”‚ â† ç‚¹å‡»çœ‹è¯¦æƒ…æˆ–å¿«é€Ÿè´­ç¥¨
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
ğŸ”Ÿ ç”¨æˆ·ç‚¹å‡»æŸä¸ªç”µå½±çš„"å¿«é€Ÿè´­ç¥¨"æŒ‰é’®
   // portal/index.vue
   const handleQuickBuy = (movie) => {
     currentMovie.value = movie;
     seatDialogVisible.value = true;  // æ‰“å¼€è´­ç¥¨å¼¹çª—
   };
   â”‚
   â–¼
1ï¸âƒ£1ï¸âƒ£ æ˜¾ç¤ºåº§ä½é€‰æ‹©å¼¹çª—ï¼ˆReBookingDialog ç»„ä»¶ï¼‰
    onMounted(() => {
      // è·å–è¯¥åœºæ¬¡çš„åº§ä½ä¿¡æ¯
      getShowSeats(showId);  // è°ƒç”¨ API: GET /api/shows/{showId}/seats
    });
   â”‚
   â–¼
1ï¸âƒ£2ï¸âƒ£ åç«¯è¿”å›åº§ä½åˆ—è¡¨
    [
      { id: "1-1", type: "regular", status: "available", price: 45 },
      { id: "1-2", type: "vip", status: "sold", price: 55 },
      ...
    ]
   â”‚
   â–¼
1ï¸âƒ£3ï¸âƒ£ å‰ç«¯æ˜¾ç¤ºåº§ä½å›¾
    ç”¨æˆ·å¯ä»¥ç‚¹å‡»åº§ä½ï¼š
    â˜ â˜ â˜ â˜ â˜
    â˜ â˜‘ â˜‘ â˜ â˜
    â˜ â˜ â˜ â˜ â˜
    
    // ç‚¹å‡»åº§ä½
    const handleSeatClick = (seat) => {
      if (selectedSeats.includes(seat.id)) {
        // å·²é€‰ä¸­ï¼Œå–æ¶ˆé€‰æ‹©
        selectedSeats.remove(seat.id);
      } else {
        // æœªé€‰ä¸­ï¼ŒåŠ å…¥é€‰æ‹©
        selectedSeats.push(seat.id);
      }
    };
   â”‚
   â–¼
1ï¸âƒ£4ï¸âƒ£ ç”¨æˆ·ç‚¹å‡»"ä¸‹å•"æŒ‰é’®
    // ReBookingDialog ç»„ä»¶
    const handleCreateOrder = async () => {
      const result = await createOrder({
        userId: userStore.userId,
        showId: currentShow.value.id,
        seatIds: selectedSeats.value
      });
      
      if (result.success) {
        // ä¸‹å•æˆåŠŸï¼Œè·³è½¬åˆ°æ”¯ä»˜é¡µé¢
        router.push({
          name: "Payment",
          query: { orderId: result.data.orderId }
        });
      }
    };
   â”‚
   â–¼
1ï¸âƒ£5ï¸âƒ£ åç«¯åˆ›å»ºè®¢å•ï¼Œè¿”å›è®¢å•ID
    {
      orderId: "ORD-20241223001",
      totalAmount: 100,
      status: "RESERVED"
    }
   â”‚
   â–¼
1ï¸âƒ£6ï¸âƒ£ å‰ç«¯æ˜¾ç¤ºæ”¯ä»˜é¡µé¢
    è®¢å•å·ï¼šORD-20241223001
    æ€»é‡‘é¢ï¼šÂ¥100
    [ç«‹å³æ”¯ä»˜]
   â”‚
   â–¼
1ï¸âƒ£7ï¸âƒ£ ç”¨æˆ·ç‚¹å‡»"ç«‹å³æ”¯ä»˜"
    // è°ƒç”¨æ”¯ä»˜ API
    const handlePayment = async () => {
      const result = await payOrder({
        orderId: "ORD-20241223001"
      });
      
      if (result.success) {
        message("æ”¯ä»˜æˆåŠŸ");
        // è¿”å›é¦–é¡µæˆ–è®¢å•åˆ—è¡¨
        router.push("/cinema/portal");
      }
    };
   â”‚
   â–¼
1ï¸âƒ£8ï¸âƒ£ åç«¯å¤„ç†æ”¯ä»˜
    è®¢å•çŠ¶æ€ï¼šRESERVED â†’ PAID
    åº§ä½çŠ¶æ€ï¼šlocked â†’ sold
   â”‚
   â–¼
1ï¸âƒ£9ï¸âƒ£ æ”¯ä»˜æˆåŠŸï¼Œé¡µé¢æ˜¾ç¤ºæˆåŠŸæç¤º
    âœ… è´­ç¥¨æˆåŠŸ
    
å®Œæˆï¼ç”¨æˆ·æˆåŠŸè´­ç¥¨ ğŸ‰
```

---

## å…³é”®ä»£ç è¯¦è§£

### 1. ç™»å½•é¡µé¢çš„å®ç°

**æ–‡ä»¶ï¼š** `views/login/index.vue`

```vue
<script setup lang="ts">
import { ref, reactive } from "vue";
import { useRouter } from "vue-router";
import { getLogin } from "@/api/user";
import { useUserStoreHook } from "@/store/modules/user";
import { message } from "@/utils/message";

const router = useRouter();
const userStore = useUserStoreHook();

// ğŸ“Œ 1. å®šä¹‰å“åº”å¼æ•°æ®
const ruleForm = reactive({
  username: "",
  password: ""
});
const loading = ref(false);

// ğŸ“Œ 2. ç™»å½•å‡½æ•°
const onLogin = async () => {
  loading.value = true;
  try {
    // è°ƒç”¨åç«¯ç™»å½•æ¥å£
    const result = await getLogin(ruleForm);
    
    if (result.success) {
      // âœ… ç™»å½•æˆåŠŸ
      
      // ğŸ“Œ 3. ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ° Pinia store
      const { userId, username, roles } = result.data.data;
      userStore.SET_USERID(userId);
      userStore.SET_USERNAME(username);
      userStore.SET_ROLES(roles);
      
      // ğŸ“Œ 4. æ˜¾ç¤ºæˆåŠŸæç¤º
      message("ç™»å½•æˆåŠŸ", { type: "success" });
      
      // ğŸ“Œ 5. è·³è½¬åˆ°é¦–é¡µ
      router.push("/cinema/portal");
    } else {
      // âŒ ç™»å½•å¤±è´¥
      message(result.message, { type: "error" });
    }
  } finally {
    loading.value = false;
  }
};
</script>

<template>
  <div class="login-container">
    <!-- ç”¨æˆ·åè¾“å…¥æ¡† -->
    <el-input 
      v-model="ruleForm.username" 
      placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
    />
    
    <!-- å¯†ç è¾“å…¥æ¡† -->
    <el-input 
      v-model="ruleForm.password" 
      placeholder="è¯·è¾“å…¥å¯†ç "
      type="password"
    />
    
    <!-- ç™»å½•æŒ‰é’® -->
    <el-button 
      :loading="loading" 
      @click="onLogin"
    >
      ç™» å½•
    </el-button>
  </div>
</template>
```

**ä»£ç æ­¥éª¤è®²è§£ï¼š**

| æ­¥éª¤ | è¯´æ˜ |
|------|------|
| 1 | å®šä¹‰å“åº”å¼å˜é‡ï¼ˆusernameã€passwordï¼‰ |
| 2 | åˆ›å»ºç™»å½•å‡½æ•° |
| 3 | è°ƒç”¨ API è¯·æ±‚åç«¯ |
| 4 | å¦‚æœæˆåŠŸï¼Œä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ° Pinia store |
| 5 | è·³è½¬åˆ°é¦–é¡µ |

### 2. ç”µå½±é¦–é¡µçš„å®ç°

**æ–‡ä»¶ï¼š** `views/cinema/portal/index.vue`

```vue
<script setup lang="ts">
import { ref, onMounted } from "vue";
import { useRouter } from "vue-router";
import { getMovieList } from "@/api/cinema/movie";
import { useUserStoreHook } from "@/store/modules/user";

const router = useRouter();
const userStore = useUserStoreHook();

// ğŸ“Œ 1. å®šä¹‰å“åº”å¼æ•°æ®
const movies = ref([]);
const loading = ref(false);
const seatDialogVisible = ref(false);
const currentMovie = ref({});

// ğŸ“Œ 2. åŠ è½½ç”µå½±åˆ—è¡¨
const loadMovies = async () => {
  loading.value = true;
  try {
    // è°ƒç”¨åç«¯è·å–ç”µå½±åˆ—è¡¨ API
    const result = await getMovieList();
    
    if (result.success) {
      // âœ… è·å–æˆåŠŸï¼Œæ›´æ–° movies æ•°æ®
      movies.value = result.data || [];
    } else {
      // âŒ è·å–å¤±è´¥
      console.error("è·å–ç”µå½±åˆ—è¡¨å¤±è´¥");
      movies.value = [];
    }
  } finally {
    loading.value = false;
  }
};

// ğŸ“Œ 3. è·³è½¬åˆ°ç”µå½±è¯¦æƒ…é¡µ
const goToDetail = (movie) => {
  router.push({ 
    name: "MovieDetail", 
    params: { id: movie.id } 
  });
};

// ğŸ“Œ 4. å¿«é€Ÿè´­ç¥¨ï¼ˆæ‰“å¼€è´­ç¥¨å¼¹çª—ï¼‰
const handleQuickBuy = (movie, e) => {
  e.stopPropagation();  // é˜²æ­¢è§¦å‘å¡ç‰‡ç‚¹å‡»
  currentMovie.value = movie;
  seatDialogVisible.value = true;  // æ˜¾ç¤ºè´­ç¥¨å¼¹çª—
};

// ğŸ“Œ 5. é¡µé¢åŠ è½½æ—¶è·å–ç”µå½±
onMounted(() => {
  loadMovies();
});
</script>

<template>
  <div class="portal-container">
    <!-- é¡¶éƒ¨æ¬¢è¿è¯­ -->
    <div class="header-banner">
      <h2>ğŸ‘‹ æ¬¢è¿å›æ¥ï¼Œ{{ userStore.username }}</h2>
      <p>ä»Šæ—¥çƒ­æ˜ ç”µå½±æ¨è</p>
      <el-button 
        type="primary" 
        @click="openMyOrders"
      >
        æŸ¥çœ‹æˆ‘çš„è®¢å•
      </el-button>
    </div>

    <!-- ç”µå½±ç½‘æ ¼ -->
    <div v-loading="loading" class="movie-grid">
      <!-- å¾ªç¯æ˜¾ç¤ºæ¯ä¸ªç”µå½± -->
      <el-card 
        v-for="movie in movies" 
        :key="movie.id"
        class="movie-card"
        @click="goToDetail(movie)"
      >
        <!-- ç”µå½±å°é¢ -->
        <img 
          :src="movie.coverUrl" 
          class="movie-cover"
        />
        
        <!-- ç”µå½±ä¿¡æ¯ -->
        <div class="movie-info">
          <h3>{{ movie.title }}</h3>
          <p>â­ {{ movie.rating }}</p>
          <p>å¯¼æ¼”: {{ movie.director }}</p>
        </div>
        
        <!-- å¿«é€Ÿè´­ç¥¨æŒ‰é’® -->
        <el-button 
          size="small" 
          type="primary"
          @click="handleQuickBuy(movie, $event)"
        >
          å¿«é€Ÿè´­ç¥¨
        </el-button>
      </el-card>
    </div>

    <!-- è´­ç¥¨å¼¹çª—ï¼ˆå¼•å…¥è‡ªå®šä¹‰ç»„ä»¶ï¼‰ -->
    <ReBookingDialog 
      v-model:visible="seatDialogVisible"
      :movie="currentMovie"
    />
  </div>
</template>
```

**ä»£ç æ­¥éª¤è®²è§£ï¼š**

| æ­¥éª¤ | è¯´æ˜ |
|------|------|
| 1 | å®šä¹‰å“åº”å¼å˜é‡ï¼ˆmoviesã€loading ç­‰ï¼‰ |
| 2 | åˆ›å»º loadMovies å‡½æ•°ï¼Œè°ƒç”¨ API |
| 3 | å¦‚æœæˆåŠŸï¼Œæ›´æ–° movies å˜é‡ |
| 4 | æ¨¡æ¿ä¸­ç”¨ `v-for` å¾ªç¯æ˜¾ç¤ºæ‰€æœ‰ç”µå½± |
| 5 | ç‚¹å‡»ç”µå½±å¡ç‰‡è·³è½¬åˆ°è¯¦æƒ…é¡µ |
| 6 | ç‚¹å‡»"å¿«é€Ÿè´­ç¥¨"æ‰“å¼€è´­ç¥¨å¼¹çª— |
| 7 | é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è°ƒç”¨ loadMovies |

### 3. åº§ä½é€‰æ‹©çš„å®ç°

**æ–‡ä»¶ï¼š** `views/cinema/seat.vue`

```vue
<script setup lang="ts">
import { ref, computed, onMounted } from "vue";
import { useRoute, useRouter } from "vue-router";
import { getShowSeats, createOrder } from "@/api/booking";
import { useUserStoreHook } from "@/store/modules/user";
import { message } from "@/utils/message";

const route = useRoute();
const router = useRouter();
const userStore = useUserStoreHook();

// ğŸ“Œ 1. å®šä¹‰å“åº”å¼æ•°æ®
const showId = route.query.id;  // ä» URL è·å–åœºæ¬¡ ID
const seatList = ref([]);
const selectedSeats = ref([]);  // é€‰ä¸­çš„åº§ä½æ•°ç»„
const loading = ref(false);
const submitting = ref(false);

// ğŸ“Œ 2. è·å–åº§ä½åˆ—è¡¨
const initSeats = async () => {
  loading.value = true;
  try {
    const result = await getShowSeats(showId);
    
    if (result.success) {
      // âœ… è·å–æˆåŠŸ
      seatList.value = result.data;
    } else {
      // âŒ è·å–å¤±è´¥
      message("è·å–åº§ä½å¤±è´¥", { type: "error" });
    }
  } finally {
    loading.value = false;
  }
};

// ğŸ“Œ 3. ç‚¹å‡»åº§ä½
const handleSeatClick = (seat) => {
  // å¦‚æœåº§ä½å·²å”®å‡ºæˆ–è¢«é”å®šï¼Œæ— æ³•é€‰æ‹©
  if (seat.status !== "available") return;
  
  const index = selectedSeats.value.indexOf(seat.id);
  
  if (index !== -1) {
    // å·²é€‰ä¸­ï¼Œå–æ¶ˆé€‰æ‹©
    selectedSeats.value.splice(index, 1);
  } else {
    // æœªé€‰ä¸­ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡é™åˆ¶ï¼ˆæœ€å¤š 4 ä¸ªï¼‰
    if (selectedSeats.value.length >= 4) {
      message("ä¸€æ¬¡æœ€å¤šé€‰æ‹© 4 ä¸ªåº§ä½", { type: "warning" });
      return;
    }
    // åŠ å…¥é€‰æ‹©
    selectedSeats.value.push(seat.id);
  }
};

// ğŸ“Œ 4. è®¡ç®—æ€»ä»·ï¼ˆè®¡ç®—å±æ€§ï¼‰
const totalPrice = computed(() => {
  let sum = 0;
  selectedSeats.value.forEach(seatId => {
    // åœ¨åº§ä½åˆ—è¡¨ä¸­æ‰¾åˆ°å¯¹åº”åº§ä½ï¼Œè·å–ä»·æ ¼
    const seat = seatList.value.find(s => s.id === seatId);
    if (seat) sum += seat.price;
  });
  return sum;
});

// ğŸ“Œ 5. æäº¤è®¢å•ï¼ˆä¸‹å•ï¼‰
const submitOrder = async () => {
  // æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†åº§ä½
  if (selectedSeats.value.length === 0) {
    message("è¯·å…ˆé€‰æ‹©åº§ä½", { type: "warning" });
    return;
  }
  
  submitting.value = true;
  try {
    // è°ƒç”¨åç«¯åˆ›å»ºè®¢å• API
    const result = await createOrder({
      userId: userStore.userId,
      showId: showId,
      seatIds: selectedSeats.value
    });
    
    if (result.success) {
      // âœ… ä¸‹å•æˆåŠŸ
      const { orderId } = result.data;
      message(`ä¸‹å•æˆåŠŸï¼Œè®¢å•å·ï¼š${orderId}`, { type: "success" });
      
      // è·³è½¬åˆ°æ”¯ä»˜é¡µé¢
      router.push({
        name: "Payment",
        query: { orderId: orderId }
      });
    } else {
      // âŒ ä¸‹å•å¤±è´¥
      message(result.message, { type: "error" });
    }
  } finally {
    submitting.value = false;
  }
};

// ğŸ“Œ 6. é¡µé¢åŠ è½½æ—¶è·å–åº§ä½
onMounted(() => {
  initSeats();
});
</script>

<template>
  <div v-loading="loading" class="seat-container">
    <!-- åº§ä½å›¾ -->
    <div class="seat-grid">
      <div 
        v-for="seat in seatList" 
        :key="seat.id"
        class="seat"
        :class="[
          seat.status === 'available' ? 'available' : 'disabled',
          selectedSeats.includes(seat.id) ? 'selected' : ''
        ]"
        @click="handleSeatClick(seat)"
      >
        {{ seat.col }}
      </div>
    </div>

    <!-- é€‰åº§ä¿¡æ¯ -->
    <div class="seat-info">
      <p>å·²é€‰åº§ä½ï¼š{{ selectedSeats.join(", ") }}</p>
      <p>æ€»é‡‘é¢ï¼šÂ¥{{ totalPrice }}</p>
    </div>

    <!-- ä¸‹å•æŒ‰é’® -->
    <el-button 
      type="primary" 
      :loading="submitting"
      @click="submitOrder"
    >
      ç¡®è®¤ä¸‹å•
    </el-button>
  </div>
</template>

<style scoped>
.seat-grid {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 10px;
  margin-bottom: 20px;
}

.seat {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border: 1px solid #ccc;
  border-radius: 4px;
}

.seat.available {
  background-color: #f0f0f0;
  cursor: pointer;
}

.seat.available:hover {
  background-color: #e0e0e0;
}

.seat.selected {
  background-color: #67c23a;
  color: white;
}

.seat.disabled {
  background-color: #d3d3d3;
  cursor: not-allowed;
  color: #999;
}
</style>
```

**ä»£ç æ­¥éª¤è®²è§£ï¼š**

| æ­¥éª¤ | è¯´æ˜ |
|------|------|
| 1 | å®šä¹‰å“åº”å¼å˜é‡ï¼ˆseatListã€selectedSeatsï¼‰ |
| 2 | è°ƒç”¨ API è·å–åº§ä½åˆ—è¡¨ |
| 3 | å®ç°ç‚¹å‡»åº§ä½çš„é€‰æ‹©é€»è¾‘ |
| 4 | ä½¿ç”¨ computed è®¡ç®—æ€»ä»· |
| 5 | å®ç°ä¸‹å•é€»è¾‘ |
| 6 | é¡µé¢åŠ è½½æ—¶è°ƒç”¨ initSeats |

---

## å¸¸è§é—®é¢˜è§£ç­”

### Q1ï¼šä¸ºä»€ä¹ˆè¦ç”¨ TypeScriptï¼Ÿ

**Aï¼š** TypeScript æä¾›ç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥ï¼š

```typescript
// âŒ æ²¡æœ‰ TypeScriptï¼šä»»ä½•é”™è¯¯éƒ½è¦è¿è¡Œæ—¶å‘ç°
const user = { name: "å¼ ä¸‰" };
console.log(user.age);  // undefinedï¼Œæ²¡æœ‰æŠ¥é”™

// âœ… æœ‰ TypeScriptï¼šå¼€å‘æ—¶å°±èƒ½å‘ç°é”™è¯¯
const user: { name: string } = { name: "å¼ ä¸‰" };
console.log(user.age);  // âŒ ç¼–è¯‘é”™è¯¯ï¼ŒIDE ä¼šæç¤º
```

### Q2ï¼š`ref()` å’Œæ™®é€šå˜é‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**Aï¼š** 

```typescript
// âŒ æ™®é€šå˜é‡ï¼šä¿®æ”¹åé¡µé¢ä¸æ›´æ–°
let count = 0;
count = 1;  // é¡µé¢ä¸ä¼šæ›´æ–°

// âœ… ref() å“åº”å¼å˜é‡ï¼šä¿®æ”¹åé¡µé¢è‡ªåŠ¨æ›´æ–°
const count = ref(0);
count.value = 1;  // é¡µé¢è‡ªåŠ¨æ›´æ–°
```

### Q3ï¼šä¸ºä»€ä¹ˆè¦ç”¨ Pinia å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Ÿ

**Aï¼š** ç”¨æˆ·ä¿¡æ¯ï¼ˆuserIdã€usernameï¼‰æ˜¯**å…¨å±€å…±äº«æ•°æ®**ï¼Œå¤šä¸ªé¡µé¢éƒ½éœ€è¦ç”¨åˆ°ã€‚

ä½¿ç”¨ Pinia çš„ä¼˜ç‚¹ï¼š
- âœ… ä»»ä½•ç»„ä»¶éƒ½èƒ½è®¿é—®
- âœ… ç™»å½•åè‡ªåŠ¨ä¿å­˜
- âœ… é¿å…å±‚å±‚ä¼ é€’

### Q4ï¼š`async/await` æ˜¯ä»€ä¹ˆï¼Ÿ

**Aï¼š** ç”¨æ¥å¤„ç†**å¼‚æ­¥æ“ä½œ**ï¼ˆå¦‚ç­‰å¾…ç½‘ç»œè¯·æ±‚å®Œæˆï¼‰ã€‚

```typescript
// âŒ æ—§æ–¹å¼ï¼ˆå›è°ƒå‡½æ•°ï¼‰
getMovieList((movies) => {
  console.log(movies);
});

// âœ… æ–°æ–¹å¼ï¼ˆasync/awaitï¼Œæ›´æ¸…æ™°ï¼‰
const movies = await getMovieList();
console.log(movies);
```

### Q5ï¼šå¦‚ä½•è°ƒè¯•å‰ç«¯ä»£ç ï¼Ÿ

**Aï¼š** ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š

1. **æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼š** F12
2. **åˆ‡æ¢åˆ° Sources æ ‡ç­¾**
3. **åœ¨ä»£ç è¡Œå·ç‚¹å‡»æ·»åŠ æ–­ç‚¹**
4. **åˆ·æ–°é¡µé¢ï¼Œä»£ç ä¼šæš‚åœåœ¨æ–­ç‚¹å¤„**
5. **ä½¿ç”¨å³ä¾§é¢æ¿æŸ¥çœ‹å˜é‡å€¼**

```typescript
// æˆ–è€…ç”¨ console.log è¾“å‡ºæ—¥å¿—
console.log("ç”¨æˆ·ä¿¡æ¯:", userStore.userId);
```

### Q6ï¼šå¦‚ä½•å¤„ç† API è¯·æ±‚é”™è¯¯ï¼Ÿ

**Aï¼š** ä½¿ç”¨ `try/catch` æ•è·å¼‚å¸¸ï¼š

```typescript
const fetchMovies = async () => {
  try {
    // å°è¯•æ‰§è¡Œ
    const result = await getMovieList();
    if (result.success) {
      movies.value = result.data;
    } else {
      // ä¸šåŠ¡é”™è¯¯ï¼ˆåç«¯è¿”å› success: falseï¼‰
      message(result.message, { type: "error" });
    }
  } catch (error) {
    // ç½‘ç»œé”™è¯¯æˆ–å…¶ä»–å¼‚å¸¸
    console.error("è·å–ç”µå½±åˆ—è¡¨å¼‚å¸¸:", error);
    message("è·å–å¤±è´¥ï¼Œè¯·é‡è¯•", { type: "error" });
  } finally {
    // æ— è®ºæˆåŠŸå¤±è´¥éƒ½æ‰§è¡Œï¼ˆé€šå¸¸ç”¨æ¥å…³é—­ loadingï¼‰
    loading.value = false;
  }
};
```

### Q7ï¼šå¦‚ä½•åœ¨ç»„ä»¶ä¸­ä¼ é€’æ•°æ®ï¼Ÿ

**Aï¼š** æœ‰å‡ ç§æ–¹å¼ï¼š

**æ–¹å¼1ï¼šçˆ¶ä¼ å­ï¼ˆPropsï¼‰**
```typescript
// å­ç»„ä»¶ Child.vue
<script setup>
  const props = defineProps({
    movie: Object
  });
  
  console.log(props.movie.title);
</script>

// çˆ¶ç»„ä»¶ Parent.vue
<Child :movie="currentMovie" />
```

**æ–¹å¼2ï¼šå­ä¼ çˆ¶ï¼ˆemitï¼‰**
```typescript
// å­ç»„ä»¶ Child.vue
const emit = defineEmits(['update']);
const handleClick = () => {
  emit('update', newValue);
};

// çˆ¶ç»„ä»¶ Parent.vue
<Child @update="handleUpdate" />
```

**æ–¹å¼3ï¼šå…¨å±€æ•°æ®ï¼ˆPiniaï¼‰**
```typescript
// ä»»ä½•ç»„ä»¶éƒ½èƒ½è®¿é—®
const userStore = useUserStoreHook();
console.log(userStore.userId);
```

### Q8ï¼šå¦‚ä½•å®ç°é¡µé¢é—´ä¼ é€’å‚æ•°ï¼Ÿ

**Aï¼š** ä½¿ç”¨è·¯ç”±å‚æ•°æˆ–æŸ¥è¯¢å‚æ•°ï¼š

```typescript
// åŠ¨æ€è·¯ç”±å‚æ•°
router.push({ 
  name: "MovieDetail", 
  params: { id: "MOV-001" }  // URL: /cinema/detail/MOV-001
});

// è·å–å‚æ•°
const route = useRoute();
console.log(route.params.id);  // MOV-001

// æˆ–è€…ç”¨æŸ¥è¯¢å‚æ•°
router.push({
  path: "/cinema/seat",
  query: { showId: "SHOW-001" }  // URL: /cinema/seat?showId=SHOW-001
});

// è·å–å‚æ•°
console.log(route.query.showId);  // SHOW-001
```

### Q9ï¼šå¦‚ä½•å®ç°åŠ è½½åŠ¨ç”»ï¼Ÿ

**Aï¼š** ä½¿ç”¨ `loading` å“åº”å¼å˜é‡å’Œ `v-loading` æŒ‡ä»¤ï¼š

```typescript
const loading = ref(false);

const fetchData = async () => {
  loading.value = true;
  try {
    // ç½‘ç»œè¯·æ±‚
    await getMovieList();
  } finally {
    loading.value = false;  // æ— è®ºæˆåŠŸå¤±è´¥éƒ½å…³é—­ loading
  }
};
```

```html
<!-- æ˜¾ç¤ºåŠ è½½åŠ¨ç”» -->
<div v-loading="loading">
  <p>æ•°æ®åŠ è½½ä¸­...</p>
</div>

<!-- æˆ–ç”¨åœ¨æŒ‰é’®ä¸Š -->
<el-button :loading="loading" @click="fetchData">
  æœç´¢
</el-button>
```

### Q10ï¼šå¦‚ä½•ä¿®æ”¹å…¨å±€æ ·å¼ï¼Ÿ

**Aï¼š** ç¼–è¾‘ `src/style/index.scss`ï¼š

```scss
// å…¨å±€æ ·å¼
body {
  font-family: "Microsoft YaHei", sans-serif;
  background-color: #f5f5f5;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
}

// CSS å˜é‡ï¼ˆå¯åœ¨æ‰€æœ‰ç»„ä»¶ä¸­ä½¿ç”¨ï¼‰
:root {
  --primary-color: #67c23a;
  --text-color: #333;
}
```

---

## æ€»ç»“

å‰ç«¯é¡¹ç›®ä¸»è¦åŒ…æ‹¬ï¼š

| éƒ¨åˆ† | ä½œç”¨ | å…³é”®æ–‡ä»¶ |
|------|------|---------|
| **é¡µé¢** | ç”¨æˆ·çœ‹åˆ°çš„å†…å®¹ | `views/` ç›®å½• |
| **ç»„ä»¶** | å¯å¤ç”¨çš„ UI å•å…ƒ | `components/` ç›®å½• |
| **API** | ä¸åç«¯é€šä¿¡ | `api/` ç›®å½• |
| **çŠ¶æ€ç®¡ç†** | å…¨å±€æ•°æ®å…±äº« | `store/` ç›®å½• |
| **è·¯ç”±** | URL ä¸é¡µé¢æ˜ å°„ | `router/` ç›®å½• |
| **æ ·å¼** | é¡µé¢å¤–è§‚ | `style/` ç›®å½• |

**å­¦ä¹ è·¯å¾„å»ºè®®ï¼š**

1. ä» **views/** ç†è§£é¡µé¢ç»“æ„
2. å­¦ä¹  **components/** çš„ç»„ä»¶å¼€å‘
3. æŒæ¡ **store/** çš„çŠ¶æ€ç®¡ç†
4. ç†è§£ **router/** çš„è·¯ç”±å¯¼èˆª
5. ç ”ç©¶ **api/** çš„åç«¯é€šä¿¡

å¸Œæœ›è¿™ä»½æ–‡æ¡£èƒ½å¸®åŠ©ä½ ç†è§£å‰ç«¯ä»£ç ï¼æœ‰é—®é¢˜éšæ—¶æé—® ğŸ˜Š

